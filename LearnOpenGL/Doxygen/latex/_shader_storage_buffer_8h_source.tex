\doxysection{Shader\+Storage\+Buffer.\+h}
\hypertarget{_shader_storage_buffer_8h_source}{}\label{_shader_storage_buffer_8h_source}\index{LearnOpenGL/ShaderStorageBuffer.h@{LearnOpenGL/ShaderStorageBuffer.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ "{}BufferDataStore.h"{}}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <glad/glad.h>}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <glm/glm.hpp>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <glm/gtc/matrix\_transform.hpp>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <glm/gtc/type\_ptr.hpp>}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \textcolor{comment}{//There\ can\ only\ be\ one\ array\ of\ variable\ size\ per\ SSBO\ and\ it\ has\ to\ be\ the\ bottommost\ variable\ in\ the\ block\ definition.}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{keyword}{enum}\ ssboTypes\ \{\ \textcolor{comment}{//\ is\ dit\ wel\ nodig?}}
\DoxyCodeLine{00015\ \ \ \ \ dirLightMVPMatrixSSBO\ =\ 0,}
\DoxyCodeLine{00016\ \ \ \ \ flashLightMVPMatrixSSBO\ =\ 1,}
\DoxyCodeLine{00017\ \ \ \ \ spotLightMVPMatrixSSBO\ =\ 2,}
\DoxyCodeLine{00018\ \ \ \ \ normalMatrixSSBO\ =\ 3,}
\DoxyCodeLine{00019\ \ \ \ \ modelViewMatrixSSBO\ =\ 4,}
\DoxyCodeLine{00020\ \ \ \ \ MVPMatrixSSBO\ =\ 5,}
\DoxyCodeLine{00021\ \ \ \ \ undefinedSSBO\ =\ 6,}
\DoxyCodeLine{00022\ \};}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{keyword}{enum}\ ssboBindingPoints\ \{}
\DoxyCodeLine{00025\ \ \ \ \ normalMatrixBP\ =\ 2,}
\DoxyCodeLine{00026\ \ \ \ \ modelViewMatrixBP\ =\ 3,}
\DoxyCodeLine{00027\ \ \ \ \ MVPMatrixBP\ =\ 4,}
\DoxyCodeLine{00028\ \ \ \ \ dirLightMVPMatrixBP\ =\ 5,}
\DoxyCodeLine{00029\ \ \ \ \ spotLightMVPMatrixBP\ =\ 6,}
\DoxyCodeLine{00030\ \ \ \ \ flashLightMVPMatrixBP\ =\ 7,}
\DoxyCodeLine{00031\ \ \ \ \ depthMapBP\ =\ 8,}
\DoxyCodeLine{00032\ \ \ \ \ singleColorBP\ =\ 20,}
\DoxyCodeLine{00033\ \ \ \ \ uberBP\ =\ 24,}
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{comment}{//lightMVPMatrixBP\ =\ 32,}}
\DoxyCodeLine{00035\ \};}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_shader_storage_buffer}{ShaderStorageBuffer}}\ \{}
\DoxyCodeLine{00038\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00039\ \ \ \ \ \mbox{\hyperlink{class_shader_storage_buffer}{ShaderStorageBuffer}}(GLuint\ bindingPoint,\ \textcolor{keywordtype}{int}\ elementCount,\ GLsizeiptr\ elementSize,\ ssboTypes\ type\ =\ ssboTypes::undefinedSSBO);}
\DoxyCodeLine{00040\ \ \ \ \ \mbox{\hyperlink{class_shader_storage_buffer}{ShaderStorageBuffer}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_shader_storage_buffer}{ShaderStorageBuffer}}\&\ other)\ =\ \textcolor{keyword}{delete};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Copy\ constructor}}
\DoxyCodeLine{00041\ \ \ \ \ \mbox{\hyperlink{class_shader_storage_buffer}{ShaderStorageBuffer}}\&\ operator=(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_shader_storage_buffer}{ShaderStorageBuffer}}\&\ other)\ =\ \textcolor{keyword}{delete};\ \ \ \ \ \ \ \ \textcolor{comment}{//\ Copy\ assignment}}
\DoxyCodeLine{00042\ \ \ \ \ \mbox{\hyperlink{class_shader_storage_buffer}{ShaderStorageBuffer}}(\mbox{\hyperlink{class_shader_storage_buffer}{ShaderStorageBuffer}}\&\&\ other)\ \textcolor{keyword}{noexcept}\ =\ \textcolor{keyword}{delete};\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Move\ constructor\ }}
\DoxyCodeLine{00043\ \ \ \ \ \mbox{\hyperlink{class_shader_storage_buffer}{ShaderStorageBuffer}}\&\ operator=(\mbox{\hyperlink{class_shader_storage_buffer}{ShaderStorageBuffer}}\&\&\ other)\ \textcolor{keyword}{noexcept}\ =\ \textcolor{keyword}{delete};\ \ \ \ \textcolor{comment}{//\ Move\ assignment}}
\DoxyCodeLine{00044\ \ \ \ \ \mbox{\hyperlink{class_shader_storage_buffer}{\string~ShaderStorageBuffer}}();\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Destructor}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keyword}{const}\ GLuint\ getId()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_id;\ \};}
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{keyword}{const}\ ssboTypes\ getType()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_ssboType;\ \};}
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{keywordtype}{void}\ setType(ssboTypes\ type)\ \{\ m\_ssboType\ =\ type;\ \};}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ getBindingPoint()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ m\_bindingPoint;\ \};}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{keywordtype}{void}\ bind()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keywordtype}{void}\ bindOverrideBindingPoint(GLuint\ BP)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{comment}{//void\ unbind()\ const;}}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{comment}{//\ Pass-\/through\ functions\ BufferDataStore}}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keywordtype}{void}\ updateSubset(\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ data,\ GLintptr\ elementIndex,\ \textcolor{keywordtype}{bool}\ upload)\ \{\ m\_BufferDataStore.updateSubset(data,\ elementIndex,\ upload);\ \};}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keywordtype}{void}\ updateFully(\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ data,\ \textcolor{keywordtype}{bool}\ upload)\ \{\ m\_BufferDataStore.updateFully(data,\ upload);\ \};}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keywordtype}{void}\ uploadUntilSubset(\textcolor{keywordtype}{int}\ untilElementIndex\ =\ 1)\ \{\ m\_BufferDataStore.uploadUntilSubset(untilElementIndex);\ \};}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keywordtype}{void}\ uploadFully()\ \{\ m\_BufferDataStore.uploadFully();\ \};}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00062\ \ \ \ \ GLuint\ m\_id\{\};}
\DoxyCodeLine{00063\ \ \ \ \ ssboTypes\ m\_ssboType\{\ ssboTypes::undefinedSSBO\ \};}
\DoxyCodeLine{00064\ \ \ \ \ GLuint\ m\_bindingPoint\{\};}
\DoxyCodeLine{00065\ \ \ \ \ \mbox{\hyperlink{class_buffer_data_store}{BufferDataStore}}\ m\_BufferDataStore;}
\DoxyCodeLine{00066\ \};}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \textcolor{comment}{//\ USAGE\ (without\ this\ class)}}
\DoxyCodeLine{00069\ \textcolor{comment}{//\ First\ define\ some\ max\ count\ int\ (e.g.\ ssboArrayCount)\ }}
\DoxyCodeLine{00070\ \textcolor{comment}{//\ Make\ and\ initialize\ an\ array\ (e.g.\ ssbo1ModelViewArray)}}
\DoxyCodeLine{00071\ \textcolor{comment}{//\ Array\ can\ be\ left\ empty\ or\ filled\ at\ this\ point}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \textcolor{comment}{//\ Insert\ the\ data\ into\ the\ buffer\ with\ glNamedBufferStorage}}
\DoxyCodeLine{00074\ \textcolor{comment}{//\ The\ size\ of\ the\ the\ buffer\ is\ fixed\ for\ the\ rest\ of\ it's\ life\ span\ after\ executing\ glNamedBufferStorage}}
\DoxyCodeLine{00075\ \textcolor{comment}{//\ So\ there\ is\ no\ need\ to\ use\ a\ vector}}
\DoxyCodeLine{00076\ \textcolor{comment}{//\ glNamedBufferStorage\ is\ executed\ first\ with\ the\ maximum\ size\ you\ need,\ just\ use\ this\ only\ once\ I\ guess}}
\DoxyCodeLine{00077\ \textcolor{comment}{//}}
\DoxyCodeLine{00078\ \textcolor{comment}{//\ If\ you\ want\ to\ replace\ existing\ ssbo\ data,\ then\ use\ glNamedBufferSubData\ starting\ from\ byte\ 0,\ e.g.:}}
\DoxyCodeLine{00079\ \textcolor{comment}{//\ glNamedBufferSubData(ssboModelView,\ 0,\ sizeof(glm::mat4)*\ ssbo1ModelViewArray.size(),\ (const\ void*)ssbo1ModelViewArray.data());}}
\DoxyCodeLine{00080\ \textcolor{comment}{//\ }}
\DoxyCodeLine{00081\ \textcolor{comment}{//\ When\ you\ need\ to\ draw\ less\ then\ the\ maximum\ amount\ of\ elements\ of\ the\ array}}
\DoxyCodeLine{00082\ \textcolor{comment}{//\ }}
\DoxyCodeLine{00083\ \textcolor{comment}{//\ Fill\ the\ array\ per\ element\ using\ a\ loop}}
\DoxyCodeLine{00084\ \textcolor{comment}{//\ OR}}
\DoxyCodeLine{00085\ \textcolor{comment}{//\ just\ fill\ element\ 0\ if\ you\ just\ need\ to\ draw\ 1\ instance}}
\DoxyCodeLine{00086\ \textcolor{comment}{//\ ssbo1ModelViewArray[0]\ =\ modelView;}}
\DoxyCodeLine{00087\ \textcolor{comment}{//\ Be\ sure\ not\ the\ use\ the\ other,\ not-\/updated,\ elements}}
\DoxyCodeLine{00088\ \textcolor{comment}{//\ Use\ the\ same\ index\ for\ the\ draw\ call\ as\ used\ in\ the\ loop\ to\ guard\ against\ this}}
\DoxyCodeLine{00089\ \textcolor{comment}{//\ }}
\DoxyCodeLine{00090\ \textcolor{comment}{//\ And\ be\ sure\ not\ to\ fill\ beyond\ \ the\ array\ capacity}}
\DoxyCodeLine{00091\ \textcolor{comment}{//\ you\ can\ use\ an\ assert:}}
\DoxyCodeLine{00092\ \textcolor{comment}{//\ assert(std::size(Data::cubePositions)\ <=\ ssboArrayCount\ \&\&\ "{}Loop\ will\ create\ more\ instances\ then\ ssbo\ can\ hold"{});}}
\DoxyCodeLine{00093\ \textcolor{comment}{//\ to\ guard\ you\ against\ this}}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \textcolor{comment}{//\ https://computergraphics.stackexchange.com/questions/5323/dynamic-\/array-\/in-\/glsl}}

\end{DoxyCode}
